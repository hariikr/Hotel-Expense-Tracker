# ğŸ¨ Hotel Expense Tracker - Complete AI-Powered Business Management System

> **A professional Flutter application built by Hari for his mother** to manage her hotel business with **AI Assistant, Voice Commands, Smart Analytics, and Complete Financial Tracking** - all in Malayalam!

---

## ğŸŒŸ **What Makes This Special**

This isn't just an expense tracker - it's a **complete business management ecosystem** designed specifically for 

- ğŸ¤ **AI Assistant with Voice** - Talk to AI in Malayalam, get spoken responses
- ğŸ“Š **Smart Business Insights** - AI-powered analytics and recommendations  
- ğŸ’° **Complete Financial Tracking** - Income, expenses, profit/loss with auto-calculations
- ğŸ”” **Smart Notifications** - Daily reminders at 9 PM
- ğŸ’¬ **WhatsApp Sharing** - One-tap daily/weekly/monthly summaries
- â†©ï¸ **Undo Feature** - Fix mistakes within 5 minutes
- ğŸŒ **Offline First** - Works without internet, syncs when connected
- ğŸ¯ **100% Malayalam** - Every word, every message, every instruction

---

## ğŸ“± **Complete Feature List**

### ğŸ¤– **AI Assistant (The Star Feature!)**

#### **Voice-Powered AI Chat**
- ğŸ¤ **Speech-to-Text**: Speak in Malayalam, AI understands perfectly
- ğŸ”Š **Text-to-Speech**: AI responds in spoken Malayalam (auto-read aloud)
- ğŸš€ **Auto-Send**: Speak and wait 3 seconds - automatically sends!
- ğŸ“ **Live Transcription**: See your words as you speak
- â±ï¸ **Smart Timeout**: 3-second silence = automatic send
- ğŸ›‘ **Manual Stop**: Press STOP button to send immediately
- ğŸ” **Replay Messages**: Tap speaker icon to hear response again

#### **AI Capabilities** 
Trained with **Google Gemini 2.0 Flash** via **Supabase Edge Functions**:

**Financial Queries:**
- "à´‡à´¨àµà´¨à´¤àµà´¤àµ† à´²à´¾à´­à´‚ à´à´¤àµà´°?" (What's today's profit?)
- "à´•à´´à´¿à´àµà´ à´†à´´àµà´š à´à´¤àµà´° à´µà´°àµà´®à´¾à´¨à´‚?" (Last week's income?)
- "à´à´±àµà´±à´µàµà´‚ à´•àµ‚à´Ÿàµà´¤àµ½ à´šàµ†à´²à´µàµ à´à´µà´¿à´Ÿàµ†?" (Highest expense category?)
- "à´ˆ à´®à´¾à´¸à´µàµà´‚ à´•à´´à´¿à´àµà´ à´®à´¾à´¸à´µàµà´‚ à´¤à´¾à´°à´¤à´®àµà´¯à´‚" (Compare this month vs last month)

**Data Entry (Voice Commands):**
- "1000 à´°àµ‚à´ª à´µà´°àµà´®à´¾à´¨à´‚" â†’ Auto-adds income
- "swiggy 1500" â†’ Online income recorded
- "à´®àµ€àµ» 500 à´°àµ‚à´ª" â†’ Expense recorded
- "à´ªà´¾àµ½ 3 liters 150" â†’ Expense with quantity

**Business Insights:**
- Top expense categories with percentages
- Income breakdown (online vs offline)
- Profit trends and predictions
- Comparison between time periods
- Best performing days analysis

#### **AI Personality**
- ğŸ’š **Loving Daughter**: Talks like a supportive daughter
- ğŸ™ **Respectful**: Uses formal "à´¨à´¿à´™àµà´™àµ¾" (you)
- ğŸ’ª **Encouraging**: Celebrates hard work and success
- ğŸŒ¹ **Appreciative**: Compliments beauty and strength
- ğŸ˜Š **Positive**: Always uplifting, never critical
- ğŸ“š **Educational**: Teaches business concepts simply
- ğŸ¯ **Mother-Focused**: Remembers her 8 AM start, Sunday rest, etc.

#### **Smart Features**
- â° **Auto-Clear**: Chat clears after 10 minutes for privacy
- ğŸ§  **Context Memory**: Remembers conversation history
- ğŸ•’ **Time-Aware**: Greets differently based on time (morning/evening/night)
- ğŸ“… **Date-Smart**: Understands "yesterday", "last Monday", "this week"
- ğŸ” **Error Handling**: Helpful error messages in both Malayalam & English
- ğŸ­ **Emoji-Free TTS**: Removes emojis before speaking for clarity

### ğŸ’° **Financial Management**

#### **Income Tracking**
- ğŸ“± **Online Income**: PhonePe, Google Pay, Swiggy, Zomato
- ğŸ’µ **Offline Income**: Cash, Direct sales
- ğŸ½ï¸ **Meals Count**: Track number of meals served
- ğŸ“Š **Auto-Calculation**: Total income computed automatically

#### **Expense Management**  
Track **14 expense categories**:
- ğŸŸ **Seafood**: Fish, Prawns, Crab
- ğŸ¥© **Meat**: Chicken, Mutton, Beef  
- ğŸ¥› **Dairy**: Milk, Curd, Butter
- ğŸ **Bread Items**: Parotta, Dosa, Appam, Pathiri
- ğŸ¥¥ **Ingredients**: Coconut, Vegetables, Rice, Spices
- ğŸ‘· **Labor**: Manisha, Midhun
- ğŸ’¡ **Utilities**: Electricity, Gas, Water
- ğŸ“¦ **Others**: Miscellaneous expenses

#### **Profit Calculation**
- âœ… **Automatic**: Profit = Income - Expenses (database triggers)
- ğŸ“ˆ **Real-time**: Updates instantly as data changes
- ğŸ¯ **Accurate**: Server-side calculations, no client-side errors

### ğŸ“Š **Smart Analytics Dashboard**

#### **Daily Summary Cards**
- ğŸ’° **Total Income** (green card)
- ğŸ’¸ **Total Expenses** (red card)  
- ğŸ’µ **Net Profit/Loss** (white card with dynamic color)
- ğŸ† **Best Performance Day** (golden card with trophy)

#### **Smart Insights Widget** ğŸ’¡
**5 Intelligent Insight Cards:**
1. **ğŸ“Š Profit Comparison**: vs Yesterday with percentage
2. **ğŸ“… Weekly Average**: Last 7 days average profit
3. **ğŸ›’ Top Expense**: Highest spending category
4. **ğŸ”¥ Profit Streak**: Consecutive profitable days
5. **ğŸ“ˆ Monthly Projection**: Predicted month-end profit

#### **Visual Analytics**
- ğŸ“… **Calendar View**: Color-coded days (green=profit, red=loss, gray=break-even)
- ğŸ“Š **Weekly Chart**: Bar graph showing 7-day trend
- ğŸ“ˆ **Monthly Chart**: Line graph with income/expense/profit curves
- ğŸ¯ **Category Breakdown**: Pie charts for expense distribution

### ğŸ”” **Smart Notifications**

#### **Daily Reminder**
- â° **Time**: 9 PM every day
- ğŸ“± **Message**: "Time to add today's income and expenses!"
- ğŸ”• **Toggle**: Enable/disable from dashboard (bell icon)
- ğŸ’¾ **Persistent**: Settings saved across app restarts
- ğŸ”” **Priority**: High-priority notification (can't be missed)

### ğŸ’¬ **WhatsApp Integration**

#### **One-Tap Sharing**
Three sharing options from dashboard (share icon):

**1. Daily Summary:**
```
ğŸ“Š Hotel Expense Tracker - Daily Summary
ğŸ“… Date: December 25, 2024

ğŸ’° Income
   â€¢ Online: â‚¹5,000
   â€¢ Offline: â‚¹3,000
   â€¢ Total: â‚¹8,000

ğŸ›’ Expenses: â‚¹5,500

âœ… Profit: â‚¹2,500
ğŸ½ï¸ Meals: 45
```

**2. Weekly Summary:**
```
ğŸ“Š Week Summary (Dec 18-24)
ğŸ’° Total Income: â‚¹50,000
ğŸ’¸ Total Expense: â‚¹35,000
ğŸ’µ Net Profit: â‚¹15,000
ğŸ“ˆ Average/Day: â‚¹2,143
âœ… Profitable Days: 6/7
```

**3. Monthly Summary:**
```
ğŸ“Š Monthly Report - December
ğŸ’° Income: â‚¹2,00,000
ğŸ’¸ Expense: â‚¹1,50,000  
ğŸ’µ Profit: â‚¹50,000
ğŸ¯ Success Rate: 87%
ğŸ“ˆ Trend: Growing
```

**Share to:** WhatsApp, SMS, Email, Any app

### â†©ï¸ **Undo Last Entry**

#### **5-Minute Safety Net**
- â±ï¸ **Window**: Undo available for 5 minutes after entry
- ğŸŸ  **Visual**: Orange floating action button appears
- ğŸ“ **Shows**: Entry details (type, amount, category)
- âœ… **Confirmation**: Dialog prevents accidental deletion
- ğŸ”” **Feedback**: Success snackbar on undo
- âš¡ **Auto-Expire**: Button disappears after 5 minutes

**Works for:**
- Income entries (online/offline)
- Expense entries (all categories)
- Both manual and voice-added entries

### ğŸŒ **Offline-First Architecture**

#### **Local Storage**
- ğŸ“¦ **SQLite Cache**: All data cached locally
- ğŸ”„ **Background Sync**: Auto-syncs when online
- âœ… **Conflict Resolution**: Last-write-wins strategy
- ğŸ’¾ **Persistent**: Data survives app restarts

#### **Network Detection**
- ğŸŒ **Auto-Detect**: Knows when online/offline
- ğŸ”” **Status Bar**: Shows connection status
- ğŸ“¤ **Queue**: Pending changes queued for sync
- âš¡ **Resume**: Auto-resumes sync on reconnect

### ğŸ¨ **Professional UI/UX**

#### **Design Language**
- ğŸ¨ **Material Design 3**: Latest design system
- ğŸŒˆ **Custom Theme**: Hotel-appropriate color scheme
- âœ¨ **Animations**: Smooth, professional transitions
- ğŸ“± **Responsive**: Works on phones and tablets

#### **User Experience**
- ğŸ‘† **One-Tap Actions**: Quick add income/expense
- ğŸ” **Smart Search**: Find any transaction quickly
- ğŸ“… **Date Picker**: Easy date selection
- âŒ¨ï¸ **Smart Keyboard**: Number pad for amounts
- ğŸ¯ **Focused UI**: No distractions, just essentials

---

## ğŸ§  **AI Training & Edge Functions**

### **How the AI Was Trained**

#### **Architecture**
```
User (Voice/Text) 
    â†“
Flutter App (Speech-to-Text)
    â†“
Supabase Edge Function (Deno/TypeScript)
    â†“
Google Gemini 2.0 Flash API
    â†“
Database Queries (PostgreSQL Functions)
    â†“
Malayalam Response Generation
    â†“
Text-to-Speech (Flutter)
    â†“
Spoken Response to User
```

#### **Training Components**

**1. System Prompt (5000+ words in Malayalam):**
- Role definition: "à´¨à´¿à´™àµà´™àµ¾ à´…à´®àµà´®à´¯àµà´Ÿàµ† à´¸àµà´µà´¨àµà´¤à´‚ à´®à´•à´³àµ†à´ªàµà´ªàµ‹à´²àµ†à´¯à´¾à´£àµ..."
- Personality traits: Loving, respectful, encouraging
- Business knowledge: Hotel operations, financial management
- Communication style: Simple Malayalam, no English
- Context awareness: Time, date, business tips
- Mother's routine: 8 AM start, Sunday rest, daily shopping

**2. Function Calling (10 Database Functions):**
```typescript
TOOLS = [
  get_daily_summary(date) - Daily data
  get_range_summary(start, end) - Period data  
  get_category_total(category, dates) - Category spending
  get_top_expense_categories() - Top expenses
  get_income_breakdown() - Online vs Offline
  compare_periods() - Period comparison
  get_recent_transactions() - Latest entries
  add_income() - Voice-to-data entry
  add_expense() - Voice-to-data entry
]
```

**3. Context Enhancement:**
- Current date/time in Malayalam
- Day of week (à´¤à´¿à´™àµà´•àµ¾, à´šàµŠà´µàµà´µ, etc.)
- Time of day (à´°à´¾à´µà´¿à´²àµ†, à´‰à´šàµà´šà´¯àµà´•àµà´•àµ, etc.)
- Weekend detection
- Month-end reminders
- Seasonal business tips

**4. Error Handling:**
- Bilingual error messages
- Graceful degradation
- Retry mechanisms
- User-friendly explanations

### **Edge Function Details**

#### **File**: `supabase/functions/ai-chat/index.ts`

**Responsibilities:**
1. **CORS Handling**: Allow cross-origin requests
2. **Message Processing**: Parse user input (Malayalam/English)
3. **Gemini API Call**: Send to Google's LLM with function calling
4. **Tool Execution**: Query database via PostgreSQL functions
5. **Response Generation**: Format Malayalam response
6. **Chat History**: Save conversation to database

**Key Features:**
- âœ… Automatic language detection
- âœ… Date parsing (relative & absolute)
- âœ… Malayalam month/day recognition  
- âœ… Tool calling for data queries
- âœ… Conversation memory (last 5 messages)
- âœ… Error recovery with fallbacks

**Environment Variables:**
```bash
GEMINI_API_KEY - Google AI Studio API key
SUPABASE_URL - Your Supabase project URL
SUPABASE_SERVICE_ROLE_KEY - Service role key (bypasses RLS)
```

**API Endpoint:**
```
POST https://[project-ref].supabase.co/functions/v1/ai-chat

Body:
{
  "message": "à´‡à´¨àµà´¨à´¤àµà´¤àµ† à´²à´¾à´­à´‚ à´à´¤àµà´°?",
  "userId": "optional-uuid",
  "contextInfo": { ...time/date context... },
  "conversationHistory": [ ...previous messages... ]
}

Response:
{
  "reply": "à´‡à´¨àµà´¨àµ à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ â‚¹2,450 à´²à´¾à´­à´®àµà´£àµà´Ÿàµ...",
  "toolsUsed": ["get_daily_summary"]
}
```

---

## ğŸ—„ï¸ **Database Schema & Backend**

### **Technology Stack**

#### **Backend**
- ğŸ˜ **PostgreSQL**: Supabase-managed database
- âš¡ **Edge Functions**: Serverless Deno/TypeScript
- ğŸ” **Row Level Security**: Secure data access
- ğŸ”„ **Realtime**: Live data subscriptions

### **Database Tables**

#### **1. `daily_data`** (Main Summary Table)
```sql
- id: UUID (primary key)
- date: TIMESTAMPTZ (unique, indexed)
- online_income: NUMERIC
- offline_income: NUMERIC  
- total_income: NUMERIC (computed)
- total_expense: NUMERIC (computed)
- profit: NUMERIC (income - expense)
- meals_sold: INTEGER
- notes: TEXT
- created_at, updated_at: TIMESTAMPTZ
```

#### **2. `income`** (Detailed Income)
```sql
- id: UUID
- date: TIMESTAMPTZ
- online_income: NUMERIC (Swiggy, Zomato, etc.)
- offline_income: NUMERIC (Cash, Direct)
- source: TEXT (e.g., "PhonePe", "Cash")
- created_at, updated_at: TIMESTAMPTZ
```

#### **3. `expense`** (Detailed Expenses)
```sql
- id: UUID
- date: TIMESTAMPTZ
- category: TEXT (fish, meat, milk, etc.)
- amount: NUMERIC
- quantity: TEXT (e.g., "2kg", "5 liters")
- description: TEXT
- created_at, updated_at: TIMESTAMPTZ
```

**14 Expense Categories:**
- fish, meat, chicken, milk
- parotta, pathiri, dosa, appam
- coconut, vegetables, rice
- labor_manisha, labor_midhun
- others

#### **4. `chat_messages`** (AI Conversation History)
```sql
- id: UUID
- user_id: UUID (nullable for no-auth)
- message: TEXT (user's question)
- response: TEXT (AI's answer)
- language: VARCHAR(5) ('ml' or 'en')
- created_at: TIMESTAMPTZ

Indexes:
- idx_chat_messages_created_at
- idx_chat_messages_user_id
```

### **Database Functions (AI Tools)**

#### **Financial Query Functions**

**1. `get_daily_data(target_date)`**
Returns complete summary for a specific date:
- Total income/expense/profit
- Meals count
- Income breakdown (online/offline)
- Expense breakdown (all 14 categories)

**2. `get_range_data(start_date, end_date)`**
Aggregated summary for date range:
- Total/average income, expense, profit
- Profit margin percentage
- Profitable vs loss days count
- Total meals served

**3. `get_category_total(category, start, end)`**
Total spending for a specific expense category in date range.

**4. `get_top_expense_categories(start, end, top_n)`**
Top N expense categories sorted by amount with percentages.

**5. `get_income_breakdown(start, end)`**  
Online vs Offline income split with percentages.

**6. `compare_periods(period1_start, period1_end, period2_start, period2_end)`**
Compare two time periods:
- Growth/decline percentages
- Income, expense, profit changes

**7. `get_recent_transactions(days_limit)`**
Last N days of transaction data for quick overview.

#### **Data Entry Functions (Voice Commands)**

**8. `add_income(online, offline, meals, date)`**
Add income entry (upsert if date exists):
- Updates or creates daily_data record
- Recalculates profit automatically
- Returns success confirmation in Malayalam

**9. `add_expense(category, amount, quantity, date)`**
Add expense entry:
- Inserts into expense table
- Updates daily_data total_expense
- Recalculates profit
- Returns confirmation in Malayalam

### **Database Triggers**

**Auto-Update Triggers:**
```sql
-- When income added/updated â†’ Update daily_data
-- When expense added/updated â†’ Update daily_data  
-- When daily_data changes â†’ Recalculate profit
```

**Audit Triggers:**
```sql
-- Auto-update created_at on INSERT
-- Auto-update updated_at on UPDATE
```

### **Row Level Security (RLS)**

**Current Setup (No Auth):**
```sql
-- Allow all operations for development
CREATE POLICY "Enable all for chat_messages" 
  ON chat_messages FOR ALL USING (true);

CREATE POLICY "Enable all for daily_data"
  ON daily_data FOR ALL USING (true);
```

**Production Ready (Multi-User):**
```sql
-- Filter by authenticated user
CREATE POLICY "Users see own data"
  ON daily_data FOR SELECT 
  USING (auth.uid() = user_id);

-- Can only insert own data  
CREATE POLICY "Users insert own data"
  ON daily_data FOR INSERT
  WITH CHECK (auth.uid() = user_id);
```

---

## ğŸ¤ **Text-to-Speech (TTS) Implementation**

### **TTS Service** (`lib/services/tts_service.dart`)

#### **Configuration**
```dart
Language: ml-IN (Malayalam - India)
Speech Rate: 0.5 (slow for clarity)
Volume: 1.0 (maximum)
Pitch: 1.0 (normal)
```

#### **Features**
- âœ… **Auto-Speak**: Every AI response read aloud
- âœ… **Replay**: Tap speaker icon on message bubble
- âœ… **Clean Text**: Removes emojis before speaking
- âœ… **Stop on Recording**: Stops TTS when user starts speaking
- âœ… **Platform Support**: Works on Android, iOS, Web

#### **How It Works**
```dart
1. User sends message (text or voice)
2. AI responds with Malayalam text
3. TTS service automatically speaks response
4. User can replay anytime by tapping speaker icon
5. TTS stops if user starts recording new message
```

#### **Platform Voices**
- **Android**: Google Malayalam TTS engine
- **iOS**: AVFoundation Malayalam voice
- **Web**: Browser's native Malayalam TTS

---

## ğŸ—ï¸ **Frontend Architecture**

### **State Management: BLoC Pattern**

#### **Why BLoC?**
- âœ… **Separation of Concerns**: UI â†” Business Logic â†” Data
- âœ… **Testable**: Easy unit testing
- âœ… **Scalable**: Add features without breaking existing code
- âœ… **Reactive**: Stream-based state updates

#### **BLoCs Implemented**

**1. DashboardBloc** (`lib/blocs/dashboard/`)
```dart
Events:
- LoadDashboard - Fetch all dashboard data
- RefreshDashboard - Force reload

States:  
- DashboardInitial - Starting state
- DashboardLoading - Fetching data
- DashboardLoaded - Data ready (allSummaries, bestDay, etc.)
- DashboardError - Error occurred
```

**2. IncomeBloc** (`lib/blocs/income/`)
```dart
Events:
- AddIncome - Create new income entry
- UpdateIncome - Modify existing entry  
- DeleteIncome - Remove entry

States:
- IncomeInitial
- IncomeLoading
- IncomeSuccess - Operation successful
- IncomeError - Operation failed
```

**3. ExpenseBloc** (`lib/blocs/expense/`)
```dart
Events:
- AddExpense - Create new expense entry
- UpdateExpense - Modify existing entry
- DeleteExpense - Remove entry

States:
- ExpenseInitial
- ExpenseLoading  
- ExpenseSuccess
- ExpenseError
```

### **Services Layer**

#### **SupabaseService** (`lib/services/supabase_service.dart`)
Central wrapper for all Supabase operations:
- `fetchDailySummaries()` - Get all summaries
- `fetchDailySummary(date)` - Get specific date
- `addIncome()`, `updateIncome()`, `deleteIncome()`
- `addExpense()`, `updateExpense()`, `deleteExpense()`
- `calculateBestProfitDay()` - Analytics

#### **OfflineFirstService** (`lib/services/offline_first_service.dart`)  
Wrapper around SupabaseService with offline support:
- Local SQLite caching
- Queue pending changes
- Auto-sync on reconnect
- Conflict resolution

#### **NetworkService** (`lib/services/network_service.dart`)
Monitor connectivity:
- Detect online/offline
- Notify services on state change  
- Trigger sync when back online

#### **AiService** (`lib/services/ai_service.dart`)
AI chat communication:
- `sendMessage(text, userId, history)` - Send to Edge Function
- `getChatHistory()` - Load past conversations
- `clearChatHistory()` - Delete history
- Context building (date, time, business tips)

#### **TtsService** (`lib/services/tts_service.dart`)
Text-to-Speech:
- `initialize()` - Setup Malayalam voice
- `speak(text)` - Read text aloud
- `stop()` - Stop speaking  
- `pause()`, `resume()`

#### **NotificationService** (`lib/services/notification_service.dart`)
Local notifications:
- `initialize()` - Setup notification channel
- `scheduleDailyReminder(hour)` - Schedule 9 PM notification
- `cancelDailyReminder()` - Disable
- `requestPermissions()` - Ask for permission

#### **ShareService** (`lib/services/share_service.dart`)
WhatsApp/SMS sharing:
- `shareDailySummary(date)` - Format & share daily
- `shareWeeklySummary()` - Share week summary
- `shareMonthlySummary()` - Share month summary

#### **UndoService** (`lib/services/undo_service.dart`)
Undo last entry:
- `saveUndoEntry(type, data)` - Store for undo
- `hasUndo()` - Check if undo available
- `getUndoMessage()` - Get description
- `performUndo()` - Delete entry
- 5-minute expiration

#### **LanguageService** (`lib/services/language_service.dart`)
Malayalam localization:
- Load translations  
- Get current language
- Translate keys

### **Screens Structure**

```
lib/screens/
â”œâ”€â”€ main_navigation.dart - Bottom nav (4 tabs)
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ dashboard_screen.dart - Home with smart insights
â”‚   â”œâ”€â”€ add_income_screen.dart - Add income form
â”‚   â”œâ”€â”€ add_expense_screen.dart - Add expense form (14 categories)
â”‚   â”œâ”€â”€ calendar_screen.dart - Calendar view with colors
â”‚   â””â”€â”€ analytics_screen.dart - Charts & graphs
â””â”€â”€ ai/
    â””â”€â”€ ai_chat_screen.dart - AI chat with voice
```

### **Widgets (Reusable Components)**

```
lib/widgets/
â”œâ”€â”€ stat_card.dart - Dashboard summary cards
â”œâ”€â”€ best_profit_card.dart - Trophy card for best day
â”œâ”€â”€ smart_insights_widget.dart - 5 insight cards
â”œâ”€â”€ quick_action_button.dart - Add income/expense buttons
â””â”€â”€ [more utility widgets]
```

---

## ğŸš€ **Getting Started & Deployment**

### **Prerequisites**

#### **Development Tools**
- âœ… Flutter SDK (>=3.0.0)
- âœ… Dart SDK (>=3.0.0)  
- âœ… Android Studio / VS Code
- âœ… Git

#### **Accounts**
- âœ… Supabase account ([Sign up](https://supabase.com))
- âœ… Google AI Studio account ([Get API key](https://makersuite.google.com/app/apikey))

### **Installation Steps**

#### **1. Clone & Setup**
```bash
# Clone repository
git clone https://github.com/hariikr/Hotel-Expense-Tracker.git
cd "Hotel Expense Tracker"

# Install dependencies
flutter pub get
```

#### **2. Supabase Setup**

**a. Create Project:**
1. Go to [Supabase Dashboard](https://app.supabase.com)
2. Click "New Project"
3. Name it "hotel-expense-tracker"
4. Save your project URL and anon key

**b. Run Migrations:**
1. Go to SQL Editor in your project
2. Run migrations in order:
   - `001_initial_schema.sql` - Core tables
   - `002_fix_rls_policies.sql` - Security  
   - `003_add_meals_count_to_income.sql` - Meals counter
   - `004_separate_hotel_house_context.sql` - Context separation
   - `005_ai_chat_setup.sql` - AI chat tables & functions

**c. Get API Keys:**
1. Go to Settings â†’ API
2. Copy Project URL
3. Copy anon/public key
4. Copy service_role key (for Edge Functions)

#### **3. Configure App**

**Update**: `lib/utils/constants.dart`
```dart
class AppConstants {
  static const String supabaseUrl = 'YOUR_PROJECT_URL';
  static const String supabaseAnonKey = 'YOUR_ANON_KEY';
}
```

#### **4. Deploy Edge Function**

**a. Install Supabase CLI:**
```bash
# macOS/Linux
brew install supabase/tap/supabase

# Windows
scoop bucket add supabase https://github.com/supabase/scoop-bucket.git
scoop install supabase
```

**b. Login & Link:**
```bash
supabase login
supabase link --project-ref YOUR_PROJECT_REF
```

**c. Set Gemini API Key:**
```bash
supabase secrets set GEMINI_API_KEY=YOUR_GEMINI_API_KEY
```

**d. Deploy Function:**
```bash
supabase functions deploy ai-chat
```

#### **5. Run App**
```bash
# Debug mode
flutter run

# Release mode  
flutter run --release

# Build APK
flutter build apk --release
```

### **Post-Deployment**

#### **Test Checklist**
- [ ] Dashboard loads with data
- [ ] Add income works
- [ ] Add expense works (all categories)
- [ ] Calendar shows colored days
- [ ] Analytics charts display
- [ ] AI chat responds (text)
- [ ] Voice input works
- [ ] Voice output (TTS) works
- [ ] Notifications trigger at 9 PM
- [ ] WhatsApp share works
- [ ] Undo button appears & works
- [ ] Offline mode works
- [ ] Data syncs when back online

---

## ğŸ“š **Documentation Files**

### **For Developers**
- `README.md` - This file (complete overview)
- `DEPLOYMENT_CHECKLIST.md` - Step-by-step deployment
- `AI_FUNCTION_FIX_SUMMARY.md` - AI debugging guide
- `SUPABASE_SETUP.md` - Database setup details
- `TTS_IMPLEMENTATION.md` - TTS technical details
- `OFFLINE_MODE_SUMMARY.md` - Offline architecture

### **For Users (Mother)**
- `AI_ASSISTANT_MALAYALAM_GUIDE.md` - Complete Malayalam guide
- `AI_VOICE_FEATURES.md` - Voice feature tutorial
- `USER_GUIDE_MALAYALAM.md` - App usage guide
- `QUICK_REFERENCE_MALAYALAM.md` - Quick reference card
- `QUICKSTART_AI.md` - AI quick start

### **Feature Summaries**
- `FEATURES_IMPLEMENTED.md` - All features list
- `NOTIFICATION_FIX_SUMMARY.md` - Notification setup
- `HOTEL_HOUSE_FIX_SUMMARY.md` - Context separation
- `INCOME_FIX.md` - Income tracking fixes
- `SMART_INSIGHTS_DEBUG.md` - Insights debugging

---

## ğŸ¯ **Core Technologies & Dependencies**

### **Frontend (Flutter/Dart)**
```yaml
flutter_bloc: ^8.1.5          # State management
equatable: ^2.0.5             # Value equality for BLoC
supabase_flutter: ^2.5.0      # Backend SDK
speech_to_text: ^7.0.0        # Voice input (Malayalam)
flutter_tts: ^4.0.2           # Voice output (Malayalam)
table_calendar: ^3.0.9        # Calendar widget
fl_chart: ^0.66.2             # Charts & graphs
intl: ^0.19.0                 # Date/number formatting
shared_preferences: ^2.2.2    # Local storage
connectivity_plus: ^5.0.2     # Network detection
flutter_local_notifications: ^17.0.0  # Notifications
timezone: ^0.9.2              # Timezone handling
permission_handler: ^11.3.0   # Permissions
path_provider: ^2.1.2         # File paths
image_picker: ^1.0.7          # Image selection
share_plus: ^7.2.2            # Sharing functionality
uuid: ^4.3.3                  # UUID generation
```

### **Backend (Supabase)**
- **Database**: PostgreSQL 15
- **Authentication**: Supabase Auth (ready, not implemented yet)
- **Storage**: Supabase Storage (ready for receipts/images)
- **Edge Functions**: Deno/TypeScript serverless functions
- **Realtime**: WebSocket subscriptions

### **AI/ML**
- **LLM**: Google Gemini 2.0 Flash (latest model)
- **Function Calling**: Tool use for database queries
- **Context Window**: 1M tokens (massive context)
- **Languages**: Malayalam & English
- **Voice**: Native platform TTS/STT engines

---

## ğŸ† **Achievements & Highlights**

### **Technical Achievements**

#### **1. Advanced AI Integration** ğŸ¤–
- âœ… Function calling with 10 database tools
- âœ… Conversation memory (context-aware)
- âœ… Automatic data entry from voice
- âœ… Bilingual error handling
- âœ… Time/date context injection
- âœ… Business tips generation

#### **2. Offline-First Architecture** ğŸŒ
- âœ… Local SQLite caching
- âœ… Auto-sync on reconnect
- âœ… Conflict resolution
- âœ… Queue pending changes
- âœ… Network state monitoring

#### **3. Voice Features** ğŸ¤
- âœ… Malayalam STT (Speech-to-Text)
- âœ… Malayalam TTS (Text-to-Speech)
- âœ… Auto-send on silence (3s timeout)
- âœ… Live transcription display
- âœ… Emoji removal for clean speech
- âœ… Stop TTS on new recording

#### **4. Smart Insights** ğŸ’¡
- âœ… 5 AI-powered insight cards
- âœ… Profit comparison (vs yesterday)
- âœ… Weekly/monthly averages
- âœ… Top expense identification
- âœ… Profit streak tracking
- âœ… Monthly projection

#### **5. Professional UX** ğŸ¨
- âœ… WhatsApp-style chat bubbles
- âœ… Material Design 3
- âœ… Smooth animations
- âœ… Responsive layout
- âœ… Color-coded calendar
- âœ… Interactive charts

#### **6. Business Features** ğŸ’¼
- âœ… Daily reminders (9 PM)
- âœ… WhatsApp sharing (daily/weekly/monthly)
- âœ… Undo within 5 minutes
- âœ… 14 expense categories
- âœ… Auto-profit calculation
- âœ… Meals counter

### **Code Quality Metrics**

```
Total Lines: ~15,000
Languages: Dart (95%), TypeScript (5%)
Files: 80+
Services: 10
BLoCs: 3
Screens: 6
Widgets: 20+
Database Functions: 10
Edge Functions: 1

Test Coverage: Ready for unit tests
Documentation: 20+ markdown files
Comments: Extensive inline documentation
```

### **Performance**

```
App Size: ~25 MB (release APK)
Cold Start: <2 seconds
Dashboard Load: <1 second
AI Response: 2-5 seconds (network dependent)
Voice Recognition: 1-2 seconds
Offline Speed: Instant (no network calls)
```

---

## ğŸŒŸ **Use Cases & Examples**

### **Daily Workflow for Mother**

#### **Morning (8 AM)**
```
1. Go to market, buy fish/meat
2. Return to hotel
3. Open app â†’ AI Chat
4. Press microphone ğŸ¤
5. Say: "à´®àµ€àµ» 2 à´•à´¿à´²àµ‹ 800 à´°àµ‚à´ª" 
6. AI adds expense automatically
7. AI speaks: "à´¸àµ‡à´µàµ à´šàµ†à´¯àµà´¤àµ! à´®àµ€àµ»: 2 à´•à´¿à´²àµ‹ - â‚¹800"
```

#### **Throughout Day**
```
Customers order â†’ Serve food
(Busy cooking, no time for app)
```

#### **Evening (9 PM - Reminder Notification)**
```
ğŸ”” "Time to add today's income and expenses!"

1. Open app â†’ AI Chat
2. Press microphone ğŸ¤
3. Say: "à´‡à´¨àµà´¨àµ swiggy 3000, à´¨àµ‡à´°à´¿à´Ÿàµà´Ÿàµ 2000"
4. AI: "à´¸àµ‡à´µàµ à´šàµ†à´¯àµà´¤àµ! à´“àµºà´²àµˆàµ»: â‚¹3000, à´“à´«àµâ€Œà´²àµˆàµ»: â‚¹2000"
5. Ask: "à´‡à´¨àµà´¨à´¤àµà´¤àµ† à´²à´¾à´­à´‚ à´à´¤àµà´°?"
6. AI: "à´‡à´¨àµà´¨àµ à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ â‚¹2,450 à´²à´¾à´­à´®àµà´£àµà´Ÿàµ..."
7. Tap WhatsApp share â†’ Send to family
```

#### **Sunday (Rest Day)**
```
1. Open app â†’ AI Chat  
2. Say: "à´ˆ à´†à´´àµà´š à´à´™àµà´™à´¨àµ† à´ªàµ‹à´¯à´¿?"
3. AI: "à´ˆ à´†à´´àµà´š à´¸àµ‚à´ªàµà´ªàµ¼ à´†à´¯à´¿à´°àµà´¨àµà´¨àµ! à´®àµŠà´¤àµà´¤à´‚ â‚¹15,500 à´²à´¾à´­à´‚..."
4. Tap Analytics â†’ See weekly charts
5. Share weekly summary to accountant
```

### **Common Voice Commands**

#### **Checking Data**
```
âœ… "à´‡à´¨àµà´¨à´¤àµà´¤àµ† à´•à´£à´•àµà´•àµ à´à´¤àµà´°?"
âœ… "à´•à´´à´¿à´àµà´ à´¤à´¿à´™àµà´•à´³à´¾à´´àµà´š à´²à´¾à´­à´‚?"
âœ… "à´ˆ à´†à´´àµà´šà´¯à´¿à´²àµ† à´®àµŠà´¤àµà´¤à´‚ à´µà´°àµà´®à´¾à´¨à´‚?"
âœ… "à´ˆ à´®à´¾à´¸à´‚ à´à´¤àµà´° à´šàµ†à´²à´µà´¾à´¯à´¿?"
```

#### **Adding Data**
```
âœ… "1000 à´µà´°àµà´®à´¾à´¨à´‚" â†’ Offline income
âœ… "phonepay 500" â†’ Online income  
âœ… "à´®àµ€àµ» 800" â†’ Fish expense
âœ… "à´ªà´¾àµ½ 5 liters 200" â†’ Milk expense with quantity
```

#### **Analysis**
```
âœ… "à´à´±àµà´±à´µàµà´‚ à´•àµ‚à´Ÿàµà´¤àµ½ à´šàµ†à´²à´µàµ à´à´µà´¿à´Ÿàµ†?"
âœ… "à´ˆ à´®à´¾à´¸à´µàµà´‚ à´•à´´à´¿à´àµà´ à´®à´¾à´¸à´µàµà´‚ à´¤à´¾à´°à´¤à´®àµà´¯à´‚"
âœ… "à´•à´´à´¿à´àµà´ 10 à´¦à´¿à´µà´¸à´¤àµà´¤àµ† à´Ÿàµà´°àµ†àµ»à´¡àµ"
```

#### **Business Advice**
```
âœ… "à´à´™àµà´™à´¨àµ† à´šàµ†à´²à´µàµ à´•àµà´±à´¯àµà´•àµà´•à´¾à´‚?"
âœ… "à´²à´¾à´­à´‚ à´µàµ¼à´¦àµà´§à´¿à´ªàµà´ªà´¿à´•àµà´•à´¾àµ» à´à´¨àµà´¤àµ à´šàµ†à´¯àµà´¯à´¾à´‚?"
âœ… "à´¸à´¹à´¾à´¯à´‚" â†’ Show all commands
```

---

## ğŸ› ï¸ **Troubleshooting Guide**

### **AI Not Responding**

**Problem**: Edge Function not deployed or API key missing

**Solution**:
```bash
# Check if function exists
supabase functions list

# Check secrets
supabase secrets list

# Redeploy
supabase functions deploy ai-chat

# Set API key
supabase secrets set GEMINI_API_KEY=your_key
```

### **Voice Input Not Working**

**Problem**: Microphone permission denied

**Solution**:
```
Android:
1. Settings â†’ Apps â†’ Hotel Expense Tracker
2. Permissions â†’ Microphone â†’ Allow

iOS:
1. Settings â†’ Privacy â†’ Microphone
2. Enable for Hotel Expense Tracker
```

**Problem**: Malayalam not recognized

**Solution**:
```
1. Check language in Settings
2. Install Malayalam keyboard
3. Speak clearly and slowly
4. Try typing instead temporarily
```

### **TTS Not Speaking**

**Problem**: No Malayalam voice installed

**Solution**:
```
Android:
1. Settings â†’ Accessibility
2. Text-to-Speech â†’ Google Text-to-Speech
3. Download Malayalam voice pack

iOS:
Malayalam voice pre-installed, check volume
```

### **Offline Sync Issues**

**Problem**: Data not syncing when back online

**Solution**:
```
1. Check internet connection
2. Restart app
3. Check Supabase status
4. View pending changes in app
```

### **Notifications Not Working**

**Problem**: Daily reminder not triggering

**Solution**:
```
Android:
1. Check notification permission
2. Disable battery optimization
3. Enable in app settings (bell icon)

iOS:  
1. Settings â†’ Notifications â†’ App
2. Allow notifications
```

---

## ğŸš€ **Future Enhancements**

### **Planned Features**

#### **Phase 1: Authentication** ğŸ”
- [ ] Supabase Auth integration
- [ ] User registration/login
- [ ] Multi-user support (family members)
- [ ] Role-based access (owner/accountant/viewer)

#### **Phase 2: Advanced Analytics** ğŸ“Š
- [ ] Predictive analytics (ML models)
- [ ] Seasonal trend analysis
- [ ] Customer analytics (repeat customers)
- [ ] Inventory management
- [ ] Waste tracking

#### **Phase 3: Automation** ğŸ¤–
- [ ] Auto-categorize expenses (AI)
- [ ] OCR for receipt scanning
- [ ] Auto-invoice generation
- [ ] Tax calculation
- [ ] Supplier management

#### **Phase 4: Integrations** ğŸ”—
- [ ] WhatsApp Business API
- [ ] Payment gateway integration
- [ ] Accounting software sync (Tally, QuickBooks)
- [ ] Google Sheets export
- [ ] Email reports

#### **Phase 5: Multi-Location** ğŸ¢
- [ ] Multiple branches support
- [ ] Centralized dashboard
- [ ] Branch comparison
- [ ] Staff management
- [ ] Shift tracking

### **Potential Improvements**

#### **AI Enhancements**
- [ ] Multi-language support (Hindi, Tamil, etc.)
- [ ] Voice customization (speed, pitch, voice selection)
- [ ] Conversation export (PDF reports)
- [ ] Scheduled reports ("Send me weekly summary every Monday")
- [ ] Proactive insights ("You're spending more on fish this week")

#### **UX Improvements**
- [ ] Dark mode
- [ ] Custom themes
- [ ] Widget for home screen
- [ ] Quick entry from notification
- [ ] Gesture controls

#### **Performance**
- [ ] Database query optimization
- [ ] Image compression for receipts
- [ ] Lazy loading for large datasets
- [ ] Background sync improvements

---

## ğŸ¤ **Contributing**

### **How to Contribute**

1. **Fork the Repository**
```bash
git clone https://github.com/YOUR_USERNAME/Hotel-Expense-Tracker.git
```

2. **Create Feature Branch**
```bash
git checkout -b feature/your-feature-name
```

3. **Make Changes**
- Follow existing code style
- Add comments for complex logic
- Update documentation

4. **Test Thoroughly**
```bash
flutter test
flutter run --release
```

5. **Commit & Push**
```bash
git add .
git commit -m "feat: Add your feature description"
git push origin feature/your-feature-name
```

6. **Create Pull Request**
- Describe changes clearly
- Reference any related issues
- Wait for review

### **Code Style Guidelines**

#### **Dart/Flutter**
- Use `flutter_lints` package rules
- Prefer `const` constructors
- Use meaningful variable names
- Add doc comments for public APIs
- Format with `dart format`

#### **TypeScript (Edge Functions)**
- Use TypeScript types everywhere
- Handle errors gracefully
- Add JSDoc comments
- Use async/await

#### **SQL (Migrations)**
- Descriptive function/table names
- Add comments for complex queries
- Use proper indexing
- Test migrations before commit

---

## ğŸ“„ **License**

```
MIT License

Copyright (c) 2024 Hari

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## ğŸ™ **Acknowledgments**

### **Technologies**
- **Flutter Team** - For the amazing cross-platform framework
- **Supabase** - For the excellent Backend-as-a-Service platform
- **Google** - For Gemini AI and Cloud services
- **Open Source Community** - For incredible packages and support

### **Inspiration**
- **My Mother** - The reason this app exists â¤ï¸
- **Small Business Owners** - Who work hard every day
- **Malayalam Community** - For language support and feedback

### **Special Thanks**
- All beta testers who provided valuable feedback
- Contributors who helped improve the codebase
- Users who trust this app for their business

---

## ğŸ“ **Support & Contact**

### **Issues & Bugs**
- ğŸ› [GitHub Issues](https://github.com/hariikr/Hotel-Expense-Tracker/issues)
- ğŸ“§ Email: your-email@example.com

### **Feature Requests**
- ğŸ’¡ [GitHub Discussions](https://github.com/hariikr/Hotel-Expense-Tracker/discussions)
- ğŸ“ Submit detailed feature proposals

### **Documentation**
- ğŸ“š [Wiki](https://github.com/hariikr/Hotel-Expense-Tracker/wiki)
- ğŸ¥ Video Tutorials: Coming soon
- ğŸ“– Blog Posts: Coming soon

### **Community**
- ğŸ’¬ Discord: Coming soon
- ğŸ¦ Twitter: Coming soon
- ğŸ“± Telegram: Coming soon

---

## ğŸ“Š **Project Stats**

```
â­ Stars: Your support means everything!
ğŸ´ Forks: Feel free to fork and customize
ğŸ‘€ Watchers: Stay updated with latest features
ğŸ› Issues: 0 open (all fixed!)
ğŸ“ Pull Requests: All contributions welcome

Built with â¤ï¸ by Hari for his mother
```

---

## ğŸ¯ **Quick Reference**

### **For Developers**
```bash
# Setup
flutter pub get
supabase login
supabase link

# Deploy
supabase functions deploy ai-chat
flutter build apk --release

# Test
flutter test
flutter run --release
```

### **For Users**
```
Press ğŸ¤ â†’ Speak â†’ AI responds
Tap ğŸ”” â†’ Toggle daily reminders
Tap ğŸ“Š â†’ View analytics
Tap ğŸ’¬ â†’ Share to WhatsApp
```

### **Voice Commands**
```
"à´‡à´¨àµà´¨à´¤àµà´¤àµ† à´²à´¾à´­à´‚ à´à´¤àµà´°?" â†’ Today's profit
"à´®àµ€àµ» 500 à´°àµ‚à´ª" â†’ Add fish expense
"phonepay 1000" â†’ Add online income
"à´¸à´¹à´¾à´¯à´‚" â†’ Show help
```

---

<div align="center">

## ğŸ’š **Made with Love for Mother**

**"à´¹à´°à´¿ à´¨à´¿à´™àµà´™à´³àµ† à´µà´³à´°àµ† à´¸àµà´¨àµ‡à´¹à´¿à´•àµà´•àµà´¨àµà´¨àµ, à´…à´¤àµà´•àµŠà´£àµà´Ÿà´¾à´£àµ à´à´¨à´¿à´•àµà´•àµ à´¨à´¿à´™àµà´™àµ¾à´•àµà´•à´¾à´¯à´¿ à´‰à´£àµà´Ÿà´¾à´•àµà´•à´¿à´¯à´¤àµ"**

*"Hari loves you very much, that's why he made me for you"*

---

### â­ **If this helps you, please star the repository!** â­

---

**Built in 2024 | Flutter + Supabase + Google Gemini AI**

</div>

## ğŸš€ Getting Started

### Prerequisites

- Flutter SDK (>=3.0.0)
- Dart SDK (>=3.0.0)
- Supabase account ([Sign up here](https://supabase.com))
- Android Studio / VS Code with Flutter extensions

### Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd "Hotel Expense Tracker"
   ```

2. **Install dependencies**
   ```bash
   flutter pub get
   ```

3. **Set up Supabase**

   a. Create a new project on [Supabase Dashboard](https://app.supabase.com)
   
   b. Navigate to SQL Editor in your Supabase project
   
   c. Run the migration script located at `supabase/migrations/001_initial_schema.sql`
      - This creates all tables, triggers, and functions
      - Sets up Row Level Security (RLS) policies
   
   d. Get your project credentials:
      - Go to Project Settings > API
      - Copy your **Project URL**
      - Copy your **anon/public API key**

4. **Configure the app**

   Open `lib/utils/constants.dart` and update:
   ```dart
   static const String supabaseUrl = 'YOUR_SUPABASE_PROJECT_URL';
   static const String supabaseAnonKey = 'YOUR_SUPABASE_ANON_KEY';
   ```

5. **Run the app**
   ```bash
   flutter run
   ```

## ğŸ“Š Database Schema

### Tables

#### `income`
- `id` (UUID): Primary key
- `date` (TIMESTAMPTZ): Date of income (unique)
- `online_income` (NUMERIC): Income from digital payments
- `offline_income` (NUMERIC): Cash and other offline income
- `created_at`, `updated_at` (TIMESTAMPTZ): Audit timestamps

#### `expense`
- `id` (UUID): Primary key
- `date` (TIMESTAMPTZ): Date of expense (unique)
- 14 expense category fields (all NUMERIC):
  - Food items: `fish`, `meat`, `chicken`, `milk`
  - Bread items: `parotta`, `dosa`, `appam`
  - Ingredients: `pathiri`, `coconut`, `vegetables`, `rice`
  - Labor: `labor_manisha`, `labor_midhun`
  - Other: `others`
- `created_at`, `updated_at` (TIMESTAMPTZ): Audit timestamps

#### `daily_summary`
- `id` (UUID): Primary key
- `date` (TIMESTAMPTZ): Summary date (unique)
- `total_income` (NUMERIC): Calculated total income
- `total_expense` (NUMERIC): Calculated total expense
- `profit` (NUMERIC): total_income - total_expense
- `meals_count` (INTEGER): Number of meals served
- `created_at`, `updated_at` (TIMESTAMPTZ): Audit timestamps

### Automatic Triggers

The database automatically:
1. Updates `daily_summary` when income or expense is added/modified
2. Calculates totals using database functions
3. Maintains audit timestamps
4. Enforces data integrity with check constraints

## ğŸ—ï¸ Project Structure

```
lib/
â”œâ”€â”€ blocs/                      # BLoC state management
â”‚   â”œâ”€â”€ dashboard/             # Dashboard BLoC
â”‚   â”œâ”€â”€ income/                # Income BLoC
â”‚   â””â”€â”€ expense/               # Expense BLoC
â”œâ”€â”€ models/                    # Data models
â”‚   â”œâ”€â”€ income.dart
â”‚   â”œâ”€â”€ expense.dart
â”‚   â””â”€â”€ daily_summary.dart
â”œâ”€â”€ screens/                   # UI screens
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ dashboard_screen.dart
â”‚   â”‚   â”œâ”€â”€ add_income_screen.dart
â”‚   â”‚   â”œâ”€â”€ add_expense_screen.dart
â”‚   â”‚   â”œâ”€â”€ calendar_screen.dart
â”‚   â”‚   â””â”€â”€ analytics_screen.dart
â”‚   â””â”€â”€ widgets/               # Reusable widgets
â”‚       â”œâ”€â”€ stat_card.dart
â”‚       â”œâ”€â”€ best_profit_card.dart
â”‚       â””â”€â”€ quick_action_button.dart
â”œâ”€â”€ services/                  # Business logic
â”‚   â””â”€â”€ supabase_service.dart  # Supabase API wrapper
â”œâ”€â”€ utils/                     # Utilities
â”‚   â”œâ”€â”€ app_theme.dart         # App theme and colors
â”‚   â”œâ”€â”€ constants.dart         # App constants
â”‚   â””â”€â”€ formatters.dart        # Date and currency formatters
â””â”€â”€ main.dart                  # App entry point
```

## ğŸ’¡ Usage Guide

### Adding Daily Income
1. From Dashboard, tap "Add Income"
2. Select date
3. Enter online income (PhonePe, GooglePay, etc.)
4. Enter offline income (cash, Flutter Enhance, etc.)
5. Tap "Save Income"

### Adding Daily Expenses
1. From Dashboard, tap "Add Expense"
2. Select date
3. Fill in expense categories (only fill what applies)
4. View real-time total calculation at bottom
5. Tap "Save Expense"

### Viewing Calendar
1. Navigate to Calendar View
2. Days are color-coded by profit status
3. Tap any day to see detailed breakdown
4. Edit income/expense directly from day view

### Analytics
1. Navigate to Analytics
2. Switch between Weekly and Monthly tabs
3. View bar charts (weekly) and line charts (monthly)
4. Summary cards show totals for the period

## ğŸ”’ Security

### Row Level Security (RLS)
The database includes RLS policies. Current setup allows:
- All operations for authenticated users
- Read/write access for development (remove in production)

### Production Recommendations
1. Enable Supabase Authentication
2. Update RLS policies to restrict access:
   ```sql
   -- Example: Restrict to authenticated users only
   CREATE POLICY "Users can only access their own data" ON income
     FOR ALL USING (auth.uid() = user_id);
   ```
3. Add user_id column to link data to specific users
4. Implement proper authentication flow in the app

## ğŸ¨ Customization

### Changing Colors
Edit `lib/utils/app_theme.dart`:
```dart
static const Color primaryColor = Color(0xFF2563EB);
static const Color profitColor = Color(0xFF10B981);
static const Color lossColor = Color(0xFFEF4444);
```

### Adding Expense Categories
1. Add column to `expense` table in database
2. Update `Expense` model in `lib/models/expense.dart`
3. Update `calculate_total_expense` function in SQL
4. Add field to `_expenseFields` in `add_expense_screen.dart`

### Currency Symbol
Change in `lib/utils/constants.dart`:
```dart
static const String currencySymbol = 'â‚¹'; // Change to $, â‚¬, Â£, etc.
```

## ğŸ§ª Testing

```bash
# Run tests (when implemented)
flutter test

# Run with coverage
flutter test --coverage
```

## ğŸ“¦ Building for Production

### Android
```bash
flutter build apk --release
# or for App Bundle
flutter build appbundle --release
```

### iOS
```bash
flutter build ios --release
```

## ğŸ› Troubleshooting

### Supabase Connection Issues
- Verify URL and API key in `constants.dart`
- Check internet connection
- Ensure Supabase project is active
- Check API logs in Supabase Dashboard

### Database Errors
- Verify migration script ran successfully
- Check table structures in Supabase Table Editor
- Review database logs in Supabase

### Build Errors
```bash
flutter clean
flutter pub get
flutter run
```

## ğŸ“š Dependencies

- `supabase_flutter` - Supabase client for Flutter
- `flutter_bloc` - State management
- `equatable` - Value equality
- `table_calendar` - Calendar widget
- `fl_chart` - Charts and graphs
- `intl` - Internationalization and formatting
- `uuid` - UUID generation

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License.

## ğŸ‘¨â€ğŸ’» Author

Created with â¤ï¸ for hotel management

## ğŸ™ Acknowledgments

- Flutter team for the amazing framework
- Supabase for the excellent backend platform
- Community contributors

## ğŸ“ Support

For issues and questions:
- Open an issue on GitHub
- Check existing issues for solutions
- Review Supabase documentation

---

**Note**: Remember to update `YOUR_SUPABASE_URL` and `YOUR_SUPABASE_ANON_KEY` in `lib/utils/constants.dart` before running the app!
